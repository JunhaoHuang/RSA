// Using online Magma Calculation to compute Montgomery reduction constants. 
// http://magma.maths.usyd.edu.au/calc/
GenConstant:=function(m,bits)
	print "m=", m:Hex;
	b:=0x100000000;
	minv:=InverseMod(-m,b);
	print "-minv=", minv:Hex;
	R:=ShiftLeft(1,bits);
	print "R=", R:Hex;
	R2:=(R*R) mod m;
	print "R^2 mod m=", R2:Hex;
end function;
n:=0x00C23237AE137D1169E2B4A0128A857C93EE4ABF13B9434DD010A1728C4D94AF1E23916280394642494B9F6B504FF6C26ABD6F050B697C548A9380D4DEAE50389B29F36F255E993CDEB25B1EB07BE11414AC7D6F9C025FAA6B416DF656D1AAFDBE4342AD7D0C7D79F45E161332E486D70F7656AE4563759C9BC996FEF8C5FA5147A3C59C7AD51970AAE600DA8A26CFC841941C066720646B0D00EBD6837A62473B4563D00B4051BA81C10AD125631A4ACCA984FF31753CD3944707CC884892D380D0660F81D42DA171D1D2A7C73A2FC1051C42550DCC38EE63982D8ED69EB0AFAACACB60D5487E58B80091176082368CF3E38359F99E224553B1C235D1332391A25B2B1F2FD81A3789D18C5C32F74040B2858F605E9D6E24EACE08BBD9B44069BB067826CB86208240FD091FB0FAEC844F727A46007C50FD254E58B0A80F5A53D67621713C74B29341AEF79E5BFBB6D4CB8BC455A703D5FBF90544FF15BD9A2BE8AC7D40929158A25A1DE5E6C91A561E23C8D377D527632493F3023AEAB1003F97BF0C540A878F69B726AA41D091FF7FE370EEC1CBC5896FDAAA53616F68C416B7EC8005CED3823563F144927F2D44DEA109AC0A6FE1C28EF0F71A171EEF9AF65C3AF07860ED011A63A0CE9FEA56DD241305B2A7AF99BB5B4E8BFC334499EB0F2753B5F313C9849833BBEDDBF652F37EEF7B3313CB4DF8E0F7F4D436B4ADEA97;
GenConstant(n,4096);
p:=0x11;
GenConstant(p,2048);
q:=0x11;
GenConstant(q,2048);

// Two Constants:
ninv= 0xA6FCAD9 //ninv=-n^(-1) mod 2^32 
// RR=2^(4096)*2^(4096) mod n
RR= 0x8F2EBD88A934B5C7103CF54FD3A933B8380BF020B886298189ECB70FF37839F1C272C4112FE16073A088778AB629A8A7B25165CB4B49E873464728C4F5EF4CA35251470CB778BE76756047B41E879F4FB0C04C813C8457F9BD138A5E56363F021144473FC1B74D7422DD8C57685F21475228F8E54BE2680EBE7BF025F6BFA229BDDA2C35ADB312C88DF51872A7E1E31B985F8D9EE709CB035540A0035128B88E3C44189D2BA9308AFD59FACD16DB1605870ADB521AA9689AAF499C81632036B43D3EDA2AD34BFA90D36E6F5B3B27D7E7E5488391339DB19344584AB560FC24F70E08B31669FFBC609C74FDC037395561DAE7FAB3F8685F3D4A2C1403F6B13E0F5B836781894EBCD97757B150207339949BAB7E7543C4E28E5806E413435EF294D06EE0DE5920685DECCEA783774F263792981497CC8885974FAEDBA658B46829BC5AE11206BD03A4E7A64B460842091D02A88227DDD085819AFA3963C71DCEDAA66A2DADA3B0137527DC94120237C17815B6284268E4C0156C0A484D061AD44073DFAEA6199A53D521B933A308F36001CFB3D8F42EDD2EEDF190307694A088F3055FD2EE5286409A16A47BC56A684C3FDAE995E29B7E031CF437EEC454B3DDE92D365F88B6737010013290104031DAC8FF2EA9C5B69DB1FE40EE26255CA224BAD8175A06CCBFAF935F174AE70D055A9023780653FA983E5FE84583D54FB224